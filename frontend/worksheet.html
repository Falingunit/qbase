<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="manifest" href="/qbase/manifest.webmanifest" />
    <meta name="theme-color" content="#0e0f12" />

    <!-- iOS niceties -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <link rel="apple-touch-icon" href="/qbase/apple-touch-icon.png" />
    <base href="/qbase/" />

    <title>QBase â€” Worksheet</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <!-- Bootstrap + Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />

    <!-- Site styles -->
    <link href="./theme.css" rel="stylesheet" />
    <link href="./index.css" rel="stylesheet" />
    <link href="./worksheet.css" rel="stylesheet" />

    <!-- Site scripts -->
    <script src="config.js"></script>
    <script defer src="./navbar.js"></script>
  </head>
  <body class="bg-dark text-light">
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <a class="navbar-brand" href="./index.html">QBase</a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <!-- Left nav -->
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="./index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="./bookmarks.html">Bookmarks</a></li>
            <li class="nav-item"><a class="nav-link" href="./worksheet_index.html">Worksheets</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- TOPBAR -->
    <div class="worksheet-topbar py-2 px-3 d-flex justify-content-between align-items-center">
      <h5 class="mb-0" id="ws-title">Worksheet</h5>
      <div class="d-flex gap-2 align-items-center">
        <div class="btn-group" role="group" aria-label="Worksheet tools">
          <button id="tool-draw" class="btn btn-outline-light btn-sm" title="Draw">
            <i class="bi bi-pencil"></i>
          </button>
          <button id="tool-erase" class="btn btn-outline-light btn-sm" title="Erase">
            <i class="bi bi-eraser"></i>
          </button>
        </div>
        <button id="ws-reset" class="btn btn-outline-danger btn-sm">
          <i class="bi bi-arrow-counterclockwise"></i> Reset Worksheet
        </button>
      </div>
    </div>

    <div class="container py-3">
      <!-- Marker search -->
      <div class="d-flex flex-wrap align-items-center gap-2 mb-3">
        <div class="input-group" style="max-width: 440px">
          <span class="input-group-text"><i class="bi bi-search"></i></span>
          <input id="mark-search" class="form-control" placeholder="Search markers..." autocomplete="off" />
          <button id="mark-prev" class="btn btn-outline-secondary" title="Previous"><i class="bi bi-chevron-up"></i></button>
          <button id="mark-next" class="btn btn-outline-secondary" title="Next"><i class="bi bi-chevron-down"></i></button>
        </div>
        <span class="text-muted small" id="mark-count"></span>
      </div>

      <!-- Pages stack -->
      <div id="ws-pages" class="ws-pages"></div>

      <!-- Answer key -->
      <section id="ws-answers-wrap" class="mt-5 d-none">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0">Answer Key</h5>
          <div class="btn-group btn-group-sm" role="group" aria-label="Answer tools">
            <button id="ans-mask" class="btn btn-outline-light" title="Mask (black rounded rectangle)"><i class="bi bi-square-fill"></i></button>
            <button id="ans-reveal" class="btn btn-outline-light" title="Reveal (erase mask)"><i class="bi bi-eye"></i></button>
            <button id="ans-clear" class="btn btn-outline-danger" title="Clear masks"><i class="bi bi-trash"></i></button>
          </div>
        </div>
        <div id="ws-answers" class="ws-answers"></div>
      </section>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script defer src="./worksheet.js"></script>
  </body>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("/qbase/sw.js", { scope: "/qbase/" })
          .catch(console.error);
      });
    }
  </script>
</html>
